<% include ../partials/header %>

  <link href="/public/css/fullcalendar.min.css" rel="stylesheet">
  <script type="text/javascript" src="/public/js/moment.min.js"></script>
  <script type="text/javascript" src="/public/js/fullcalendar.min.js"></script>

  <style>
    #calendar {
        font-size: 13px;
    }
    .fc h2 {
       font-size: 25px;
    }

    th {
        background-color: lightgray;
    }

  </style>

  <div style="margin-top: 5%; overflow: visible;">
    <div class="row">
      <div class="col-sm-3">
        <div class="card">
          <div class="card-header">
            Featured
          </div>
          <div class="card-body">
            <h5 class="card-title">Special title treatment</h5>
            <p class="card-text">With supporting text below as a natural lead-in to additional content.</p>
            <a href="#" class="btn btn-primary">Go somewhere</a>
          </div>
        </div>
      </div>
      <div id='calendar' class="col-sm-9"></div>
    </div>
  </div>

  <div class="modal" tabindex="-1" role="dialog" id='modal'>
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Title</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
        </div>
        <div class="modal-body">
          <p>Modal body text goes here.</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-primary">Save changes</button>
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

  <script type="text/javascript">
    $(document).ready(function() {
      // $(window).resize(function(){
      //     if($(window).width() < 700){
      //         $("#body").css('margin-top',130);
      //     }else{
      //         $("#body").css('margin-top',120);
      //     }
      // });


      var date = new Date();
      var d = date.getDate();
      var m = date.getMonth();
      var y = date.getFullYear();

      var todayDate = moment().startOf('day');
      var YM = todayDate.format('YYYY-MM');

      $('#calendar').fullCalendar({
        header: {
            left: 'prev, next, today',
            center: 'title',
            right: 'month, agendaWeek, agendaDay'
        },
        selectable: true,
        editable: true,
        eventLimit: true,
        selectHelper: true,
        unselectAuto: false,
        slotDuration: '00:15:00',
        nowIndicator: true,
        navLinks: true,
        height: $(window).height()*0.80,
        eventClick: function(event) {
          $('#modal').modal();
        },
        eventDrop: function(event) {
          console.log('eventDrop')
        },
        eventResize: function(event) {
          console.log('eventResize')
        },
        eventRender: function(event) {
          if (event.ranges) {
            return (event.ranges.filter(function(range) { // test event against all the ranges

              return (event.start.isBefore(range.end) &&
                event.end.isAfter(range.start));

            }).length) > 0; //if it isn't in one of the ranges, don't render it (by returning false)
          } else {
            return true;
          }
        },
        events: [{
            title: 'Sales Meeting',
            start: new Date(y, m, d + 3, 10, 30),
            end: new Date(y, m, d + 3, 11, 30),
            allDay: false
          }, {
            title: 'Marketing Meeting',
            start: new Date(y, m, d - 1, 10, 30),
            end: new Date(y, m, d - 1, 11, 30),
            allDay: false
          }, {
            title: 'Production Meeting',
            start: new Date(y, m, d + 8, 10, 30),
            end: new Date(y, m, d + 8, 11, 30),
            allDay: false
          },
          {
            id: 999,
            title: 'Repeating Event',
            start: YM + '-09T16:00:00'
          },
          {
            id: 999,
            title: 'Repeating Event',
            start: YM + '-16T16:00:00'
          },
          {
            id: 1,
            title: "recurring event",
            start: "10:00",
            end: "12:00",
            dow: [1, 3, 4],
            ranges: [{
              start: new Date(y, m, d - 5, 09, 30),
              end: new Date(y, m, d + 3, 15, 30)
            }, {
              start: new Date(y, m, d + 5, 10, 00),
              end: new Date(y, m, d + 15, 12, 00)
            }]
          }
        ]
      });
    });
  </script>
  <% include ../partials/footer %>
